{% extends 'base.html' %}
{% block content %}
<h2>{{ post.title }}</h2>
<p>{{ post.content }}</p>
<p><small>By {{ post.author.username }} on {{ post.date_posted.strftime('%Y-%m-%d') }}</small></p>

{% if current_user.is_authenticated and post.author == current_user %}
  <form action="{{ url_for('edit_post', post_id=post.id) }}" method="get" style="display:inline;">
    <button type="submit">Edit</button>
  </form>
  <form action="{{ url_for('delete_post', post_id=post.id) }}" method="post" style="display:inline;">
    <button type="submit" onclick="return confirm('Are you sure you want to delete this post?');">Delete</button>
  </form>
{% endif %}

<hr>
<h3>Comments</h3>
{% for comment in post.comments %}
  <p><b>{{ comment.author.username }}</b>: {{ comment.content }}</p>
{% else %}
  <p>No comments yet.</p>
{% endfor %}

{% if current_user.is_authenticated %}
<form method="POST">
  <textarea name="content" rows="3" cols="40" placeholder="Write a comment..." required></textarea><br>
  <button type="submit">Add Comment</button>
</form>
{% else %}
<p><a href="{{ url_for('login') }}">Login</a> to comment.</p>
{% endif %}
{% endblock %}
